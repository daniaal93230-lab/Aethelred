{
  "files": [
    {
      "path": ".coveragerc",
      "size": 83,
      "first_line": "[run]",
      "docstring": null
    },
    {
      "path": ".editorconfig",
      "size": 194,
      "first_line": "root = true",
      "docstring": null
    },
    {
      "path": ".gitattributes",
      "size": 624,
      "first_line": "*               text=auto",
      "docstring": null
    },
    {
      "path": ".github/CODEOWNERS",
      "size": 20,
      "first_line": "* @daniaal93230-lab",
      "docstring": null
    },
    {
      "path": ".github/dependabot.yml",
      "size": 205,
      "first_line": "version: 2",
      "docstring": null
    },
    {
      "path": ".github/workflows/ci.yml",
      "size": 2660,
      "first_line": "\ufeffname: Aethelred CI",
      "docstring": null
    },
    {
      "path": ".github/workflows/nightly.yml",
      "size": 2341,
      "first_line": "name: Aethelred Nightly Smoke",
      "docstring": null
    },
    {
      "path": ".github/workflows/patch-inbox.yml",
      "size": 3188,
      "first_line": "name: Patch inbox (comments or issue body)",
      "docstring": null
    },
    {
      "path": ".github/workflows/update_llm_artifacts.yml",
      "size": 3612,
      "first_line": "name: Update LLM artifacts",
      "docstring": null
    },
    {
      "path": ".gitignore",
      "size": 821,
      "first_line": "\ufeff# env & caches",
      "docstring": null
    },
    {
      "path": ".pre-commit-config.yaml",
      "size": 302,
      "first_line": "\ufeffrepos:",
      "docstring": null
    },
    {
      "path": ".pytest_cache/.gitignore",
      "size": 37,
      "first_line": "# Created by pytest automatically.",
      "docstring": null
    },
    {
      "path": ".pytest_cache/CACHEDIR.TAG",
      "size": 191,
      "first_line": "Signature: 8a477f597d28d172789f06886806bc55",
      "docstring": null
    },
    {
      "path": ".pytest_cache/README.md",
      "size": 302,
      "first_line": "# pytest cache directory #",
      "docstring": null
    },
    {
      "path": ".pytest_cache/v/cache/nodeids",
      "size": 2839,
      "first_line": "[",
      "docstring": null
    },
    {
      "path": ".ruff_cache/.gitignore",
      "size": 35,
      "first_line": "# Automatically created by ruff.",
      "docstring": null
    },
    {
      "path": ".ruff_cache/0.14.3/1127600864467113360",
      "size": 130,
      "first_line": "",
      "docstring": null
    },
    {
      "path": ".ruff_cache/0.14.3/11638596181637876275",
      "size": 785,
      "first_line": "",
      "docstring": null
    },
    {
      "path": ".ruff_cache/0.14.3/12947006564008525681",
      "size": 84,
      "first_line": "",
      "docstring": null
    },
    {
      "path": ".ruff_cache/0.14.3/13113192207449778328",
      "size": 175,
      "first_line": "",
      "docstring": null
    },
    {
      "path": ".ruff_cache/0.14.3/15387219469415748884",
      "size": 102,
      "first_line": "",
      "docstring": null
    },
    {
      "path": ".ruff_cache/0.14.3/1572007642514256731",
      "size": 87,
      "first_line": "",
      "docstring": null
    },
    {
      "path": ".ruff_cache/0.14.3/16405797324829307559",
      "size": 769,
      "first_line": "",
      "docstring": null
    },
    {
      "path": ".ruff_cache/0.14.3/16686246387925838939",
      "size": 285,
      "first_line": "",
      "docstring": null
    },
    {
      "path": ".ruff_cache/0.14.3/17052952824662009193",
      "size": 80,
      "first_line": "",
      "docstring": null
    },
    {
      "path": ".ruff_cache/0.14.3/17923447209750609491",
      "size": 256,
      "first_line": "",
      "docstring": null
    },
    {
      "path": ".ruff_cache/0.14.3/2200317804781333797",
      "size": 532,
      "first_line": "",
      "docstring": null
    },
    {
      "path": ".ruff_cache/0.14.3/2387240623249400781",
      "size": 135,
      "first_line": "",
      "docstring": null
    },
    {
      "path": ".ruff_cache/0.14.3/2795729012206064471",
      "size": 109,
      "first_line": "",
      "docstring": null
    },
    {
      "path": ".ruff_cache/0.14.3/316209595474699999",
      "size": 165,
      "first_line": "",
      "docstring": null
    },
    {
      "path": ".ruff_cache/0.14.3/3754106019521563112",
      "size": 175,
      "first_line": "",
      "docstring": null
    },
    {
      "path": ".ruff_cache/0.14.3/4515496761311577799",
      "size": 203,
      "first_line": "",
      "docstring": null
    },
    {
      "path": ".ruff_cache/0.14.3/6445456710033260170",
      "size": 240,
      "first_line": "",
      "docstring": null
    },
    {
      "path": ".ruff_cache/0.14.3/7797079289912585377",
      "size": 108,
      "first_line": "",
      "docstring": null
    },
    {
      "path": ".ruff_cache/0.14.3/7822531232637135943",
      "size": 112,
      "first_line": "",
      "docstring": null
    },
    {
      "path": ".ruff_cache/0.14.3/8934466943597251918",
      "size": 87,
      "first_line": "",
      "docstring": null
    },
    {
      "path": ".ruff_cache/CACHEDIR.TAG",
      "size": 43,
      "first_line": "Signature: 8a477f597d28d172789f06886806bc55",
      "docstring": null
    },
    {
      "path": "README.md",
      "size": 2374,
      "first_line": "# Aethelred",
      "docstring": null
    },
    {
      "path": "REPO_OVERVIEW.md",
      "size": 3138,
      "first_line": "LLM-friendly Repo Overview",
      "docstring": null
    },
    {
      "path": "SECURITY.md",
      "size": 179,
      "first_line": "# Security Policy",
      "docstring": null
    },
    {
      "path": "account_runtime.json",
      "size": 222,
      "first_line": "{",
      "docstring": null
    },
    {
      "path": "analytics/metrics.py",
      "size": 8625,
      "first_line": "\"\"\"",
      "docstring": "Pure stdlib analytics over the journal DB.\nNo pandas dependency. SQLite only."
    },
    {
      "path": "api/README.md",
      "size": 410,
      "first_line": "API module",
      "docstring": null
    },
    {
      "path": "api/__init__.py",
      "size": 0,
      "first_line": "",
      "docstring": null
    },
    {
      "path": "api/app.py",
      "size": 421,
      "first_line": "from fastapi import FastAPI",
      "docstring": null
    },
    {
      "path": "api/bootstrap_real_engine.py",
      "size": 4614,
      "first_line": "\"\"\"",
      "docstring": "Bootstrap the real engine and attach it to FastAPI for uvicorn --factory.\nUsage:\n    uvicorn api.bootstrap_real_engine:create_app --host 127.0.0.1 --port 8080\nEnv:\n    LIVE=1                to prevent QA engine auto attach\n    SAFE_FLATTEN_ON_START optional safety on startup\n    SNAPSHOT_IDLE_SEC     optional idle snapshot loop interval (default 15)"
    },
    {
      "path": "api/contracts/decisions_header.py",
      "size": 280,
      "first_line": "DECISIONS_HEADER = [",
      "docstring": null
    },
    {
      "path": "api/contracts/trades_header.py",
      "size": 1409,
      "first_line": "\"\"\"",
      "docstring": "Canonical header for trades.csv that the API must serve.\nKeep this the single source of truth for downstream consumers."
    },
    {
      "path": "api/main.py",
      "size": 72940,
      "first_line": "# api/main.py",
      "docstring": null
    },
    {
      "path": "api/openapi.json",
      "size": 36395,
      "first_line": "{",
      "docstring": null
    },
    {
      "path": "api/paper_bot.py",
      "size": 7956,
      "first_line": "from __future__ import annotations",
      "docstring": null
    },
    {
      "path": "api/routes/__init__.py",
      "size": 574,
      "first_line": "from fastapi import APIRouter",
      "docstring": null
    },
    {
      "path": "api/routes/demo.py",
      "size": 2658,
      "first_line": "from __future__ import annotations",
      "docstring": null
    },
    {
      "path": "api/routes/export.py",
      "size": 8229,
      "first_line": "from fastapi import APIRouter, Response, HTTPException, Request",
      "docstring": null
    },
    {
      "path": "api/routes/insight.py",
      "size": 3059,
      "first_line": "from __future__ import annotations",
      "docstring": null
    },
    {
      "path": "api/routes/ops.py",
      "size": 2842,
      "first_line": "from typing import Optional",
      "docstring": null
    },
    {
      "path": "api/routes/qa_sim.py",
      "size": 1103,
      "first_line": "from fastapi import APIRouter",
      "docstring": null
    },
    {
      "path": "api/routes/risk.py",
      "size": 768,
      "first_line": "from typing import Any, Dict",
      "docstring": null
    },
    {
      "path": "api/routes/train.py",
      "size": 2037,
      "first_line": "from fastapi import APIRouter, HTTPException, Request",
      "docstring": null
    },
    {
      "path": "api/routes/ui.py",
      "size": 943,
      "first_line": "from fastapi import APIRouter, Response",
      "docstring": null
    },
    {
      "path": "api_contracts/ml_infer.json",
      "size": 240,
      "first_line": "{",
      "docstring": null
    },
    {
      "path": "api_contracts/ml_infer_intent_veto.json",
      "size": 380,
      "first_line": "{",
      "docstring": null
    },
    {
      "path": "api_contracts/ml_infer_stop_distance.json",
      "size": 439,
      "first_line": "{",
      "docstring": null
    },
    {
      "path": "apps/visor/streamlit_app.py",
      "size": 5978,
      "first_line": "\"\"\"",
      "docstring": "Visor: minimal truth UI for Aethelred \n Env:\n  VISOR_API_BASE   Base URL of the running API, default http://127.0.0.1:8080\nEndpoints used:\n  GET {VISOR_API_BASE}/healthz\n  GET {VISOR_API_BASE}/runtime/account_runtime.json \n Expected runtime/account_runtime.json shape (robust to missing keys):\n{\n  \"heartbeat_ts\": \"2025-10-26T18:22:15.123Z\",\n  \"equity\": [\n    {\"ts\": \"2025-10-26T18:20:00Z\", \"equity\": 100000.0},\n    {\"ts\": \"2025-10-26T18:21:00Z\", \"equity\": 100250.4},\n    ...\n  ],\n  \"positions\": [\n    {\n      \"s..."
    },
    {
      "path": "backtest_strategy.py",
      "size": 11348,
      "first_line": "# backtest_strategy.py",
      "docstring": null
    },
    {
      "path": "bot/README.md",
      "size": 345,
      "first_line": "Bot module",
      "docstring": null
    },
    {
      "path": "bot/__init__.py",
      "size": 0,
      "first_line": "",
      "docstring": null
    },
    {
      "path": "bot/auto_tuner.py",
      "size": 4202,
      "first_line": "# bot/auto_tuner.py",
      "docstring": null
    },
    {
      "path": "bot/autoparams.py",
      "size": 7921,
      "first_line": "# bot/autoparams.py",
      "docstring": null
    },
    {
      "path": "bot/brain.py",
      "size": 45664,
      "first_line": "\ufeff# bot/brain.py",
      "docstring": null
    },
    {
      "path": "bot/data_fetch.py",
      "size": 1080,
      "first_line": "try:",
      "docstring": null
    },
    {
      "path": "bot/evaluator.py",
      "size": 1029,
      "first_line": "try:",
      "docstring": null
    },
    {
      "path": "bot/exchange.py",
      "size": 11697,
      "first_line": "# bot/exchange.py",
      "docstring": null
    },
    {
      "path": "bot/indicators.py",
      "size": 46,
      "first_line": "# bot/indicators.py",
      "docstring": null
    },
    {
      "path": "bot/json_io.py",
      "size": 711,
      "first_line": "try:",
      "docstring": null
    },
    {
      "path": "bot/ledger.py",
      "size": 103,
      "first_line": "try:",
      "docstring": null
    },
    {
      "path": "bot/logger.py",
      "size": 493,
      "first_line": "# bot/logger.py",
      "docstring": null
    },
    {
      "path": "bot/main.py",
      "size": 24780,
      "first_line": "# bot/main.py",
      "docstring": null
    },
    {
      "path": "bot/ml.py",
      "size": 3278,
      "first_line": "\ufeffimport pickle",
      "docstring": null
    },
    {
      "path": "bot/news_sentiment.py",
      "size": 123,
      "first_line": "try:",
      "docstring": null
    },
    {
      "path": "bot/paper.py",
      "size": 4928,
      "first_line": "# bot/paper.py",
      "docstring": null
    },
    {
      "path": "bot/persist.py",
      "size": 866,
      "first_line": "# bot/persist.py",
      "docstring": null
    },
    {
      "path": "bot/risk.py",
      "size": 116,
      "first_line": "try:",
      "docstring": null
    },
    {
      "path": "bot/runner.py",
      "size": 2293,
      "first_line": "# runner.py",
      "docstring": null
    },
    {
      "path": "bot/strategies.py",
      "size": 204,
      "first_line": "# bot/strategies.py",
      "docstring": null
    },
    {
      "path": "bot/strategy.py",
      "size": 3098,
      "first_line": "# bot/strategy.py",
      "docstring": null
    },
    {
      "path": "bot/telegram_notifier.py",
      "size": 140,
      "first_line": "try:",
      "docstring": null
    },
    {
      "path": "bot/tune.py",
      "size": 4843,
      "first_line": "# bot/tune.py",
      "docstring": null
    },
    {
      "path": "brain_metrics.csv",
      "size": 628,
      "first_line": "ts,exchange,symbol,interval,strategy,signal,price,bars_used,ann_return,ann_vol,sharpe_ann,max_drawdown,win_rate_bar,profit_factor_bar,trade_count,avg_bar_return,paper_equity",
      "docstring": null
    },
    {
      "path": "brokers/__init__.py",
      "size": 180,
      "first_line": "\"\"\"Brokers package initializer.",
      "docstring": "Brokers package initializer. \n Ensures static type checkers treat `brokers` as a proper package,\navoiding duplicate module mapping issues (e.g., `paper` vs `brokers.paper`)."
    },
    {
      "path": "brokers/paper.py",
      "size": 1865,
      "first_line": "from __future__ import annotations",
      "docstring": null
    },
    {
      "path": "btc_metrics.csv",
      "size": 2042,
      "first_line": "ts,exchange,symbol,interval,strategy,signal,price,bars_used,ann_return,ann_vol,sharpe_ann,max_drawdown,win_rate_bar,profit_factor_bar,trade_count,avg_bar_return,paper_equity",
      "docstring": null
    },
    {
      "path": "cli/calibrate_vol_target.py",
      "size": 1497,
      "first_line": "import argparse",
      "docstring": null
    },
    {
      "path": "config/regime_map.yaml",
      "size": 251,
      "first_line": "default_env: \"prod\"",
      "docstring": null
    },
    {
      "path": "config/risk.yaml",
      "size": 929,
      "first_line": "version: 1",
      "docstring": null
    },
    {
      "path": "config/selector.yaml",
      "size": 103,
      "first_line": "defaults:",
      "docstring": null
    },
    {
      "path": "core/README.md",
      "size": 540,
      "first_line": "Core module",
      "docstring": null
    },
    {
      "path": "core/__init__.py",
      "size": 0,
      "first_line": "",
      "docstring": null
    },
    {
      "path": "core/breaker.py",
      "size": 2409,
      "first_line": "from __future__ import annotations",
      "docstring": null
    },
    {
      "path": "core/data_fetch.py",
      "size": 5113,
      "first_line": "# data_fetch.py",
      "docstring": "Module for fetching historical OHLCV data from exchanges and time frame utilities.\nUses ccxt for exchange data retrieval."
    },
    {
      "path": "core/engine.py",
      "size": 15453,
      "first_line": "# engine.py",
      "docstring": null
    },
    {
      "path": "core/engine_strategy_wiring.py",
      "size": 3006,
      "first_line": "from __future__ import annotations",
      "docstring": null
    },
    {
      "path": "core/evaluator.py",
      "size": 11274,
      "first_line": "# evaluator.py",
      "docstring": "Module for strategy evaluation including walk-forward selection, backtesting, and performance metrics.\nProvides functions to backtest trading signals and select the best strategy segments over time."
    },
    {
      "path": "core/execution_engine.py",
      "size": 29787,
      "first_line": "import time",
      "docstring": null
    },
    {
      "path": "core/indicators.py",
      "size": 2199,
      "first_line": "# indicators.py",
      "docstring": "Technical indicators for analyzing price data.\nIncludes EMA (Exponential Moving Average), RMA (Wilder's moving average), and ADX (Average Directional Index)."
    },
    {
      "path": "core/json_io.py",
      "size": 1948,
      "first_line": "# json_io.py",
      "docstring": "Utilities for emitting signals and performance data to JSON files."
    },
    {
      "path": "core/ledger.py",
      "size": 8670,
      "first_line": "# ledger.py",
      "docstring": "Paper trading ledger for tracking simulated positions and equity over time.\nRecords trades, mark-to-market updates, and maintains a persistent state (cash and position).\nOutputs a CSV transaction log and a JSON file to persist state between runs."
    },
    {
      "path": "core/ml/__init__.py",
      "size": 0,
      "first_line": "",
      "docstring": null
    },
    {
      "path": "core/ml/features.py",
      "size": 1009,
      "first_line": "from __future__ import annotations",
      "docstring": null
    },
    {
      "path": "core/ml/gate.py",
      "size": 761,
      "first_line": "from __future__ import annotations",
      "docstring": null
    },
    {
      "path": "core/ml/intent_veto.py",
      "size": 744,
      "first_line": "from __future__ import annotations",
      "docstring": null
    },
    {
      "path": "core/ml/model.py",
      "size": 1914,
      "first_line": "import numpy as np",
      "docstring": null
    },
    {
      "path": "core/ml/model_io.py",
      "size": 880,
      "first_line": "from __future__ import annotations",
      "docstring": null
    },
    {
      "path": "core/ml/stop_distance.py",
      "size": 847,
      "first_line": "# core/ml/stop_distance.py",
      "docstring": null
    },
    {
      "path": "core/ml/train_logreg.py",
      "size": 1881,
      "first_line": "from __future__ import annotations",
      "docstring": null
    },
    {
      "path": "core/ml/volume_seasonality.py",
      "size": 1130,
      "first_line": "# core/ml/volume_seasonality.py",
      "docstring": null
    },
    {
      "path": "core/ml_gate.py",
      "size": 1782,
      "first_line": "from __future__ import annotations",
      "docstring": null
    },
    {
      "path": "core/news.py",
      "size": 2593,
      "first_line": "from __future__ import annotations",
      "docstring": null
    },
    {
      "path": "core/news_sentiment.py",
      "size": 670,
      "first_line": "# news_sentiment.py",
      "docstring": "Placeholder module for news and sentiment analysis inputs."
    },
    {
      "path": "core/persistence.py",
      "size": 6466,
      "first_line": "from __future__ import annotations",
      "docstring": null
    },
    {
      "path": "core/portfolio.py",
      "size": 1037,
      "first_line": "from __future__ import annotations",
      "docstring": null
    },
    {
      "path": "core/regime.py",
      "size": 1760,
      "first_line": "from __future__ import annotations",
      "docstring": null
    },
    {
      "path": "core/risk.py",
      "size": 7948,
      "first_line": "# risk.py",
      "docstring": "Risk management and position sizing functions, including Kelly criterion calculations for sizing trades."
    },
    {
      "path": "core/risk_config.py",
      "size": 6364,
      "first_line": "import os",
      "docstring": null
    },
    {
      "path": "core/risk_helpers.py",
      "size": 3545,
      "first_line": "from typing import Dict, Any, Tuple, Callable, Optional",
      "docstring": null
    },
    {
      "path": "core/risk_profile.py",
      "size": 2512,
      "first_line": "from __future__ import annotations",
      "docstring": null
    },
    {
      "path": "core/rules/trade_dependence.py",
      "size": 605,
      "first_line": "from __future__ import annotations",
      "docstring": null
    },
    {
      "path": "core/runtime_state.py",
      "size": 1803,
      "first_line": "from __future__ import annotations",
      "docstring": null
    },
    {
      "path": "core/strategies.py",
      "size": 2358,
      "first_line": "# strategies.py",
      "docstring": "Trading strategy definitions and signal generation functions.\nIncludes moving average crossover (MA_X) as an example strategy, and utilities for applying regime filters."
    },
    {
      "path": "core/strategy/README.md",
      "size": 544,
      "first_line": "Strategy subpackage",
      "docstring": null
    },
    {
      "path": "core/strategy/base.py",
      "size": 591,
      "first_line": "from __future__ import annotations",
      "docstring": null
    },
    {
      "path": "core/strategy/donchian_breakout.py",
      "size": 1181,
      "first_line": "from __future__ import annotations",
      "docstring": null
    },
    {
      "path": "core/strategy/ma_crossover_adapter.py",
      "size": 1960,
      "first_line": "from __future__ import annotations",
      "docstring": null
    },
    {
      "path": "core/strategy/regime_config.py",
      "size": 2624,
      "first_line": "from __future__ import annotations",
      "docstring": null
    },
    {
      "path": "core/strategy/registry.py",
      "size": 757,
      "first_line": "from __future__ import annotations",
      "docstring": null
    },
    {
      "path": "core/strategy/rsi_mean_revert.py",
      "size": 1347,
      "first_line": "from __future__ import annotations",
      "docstring": null
    },
    {
      "path": "core/strategy/selector.py",
      "size": 2653,
      "first_line": "from __future__ import annotations",
      "docstring": null
    },
    {
      "path": "core/strategy/types.py",
      "size": 421,
      "first_line": "from __future__ import annotations",
      "docstring": null
    },
    {
      "path": "core/telegram_notifier.py",
      "size": 868,
      "first_line": "# telegram_notifier.py",
      "docstring": "Placeholder module for sending notifications via Telegram."
    },
    {
      "path": "core/test_execution_engine.py",
      "size": 123,
      "first_line": "from core.execution_engine import ExecutionEngine",
      "docstring": null
    },
    {
      "path": "dashboard/index.html",
      "size": 16855,
      "first_line": "<!doctype html>",
      "docstring": null
    },
    {
      "path": "db/README.md",
      "size": 317,
      "first_line": "DB module",
      "docstring": null
    },
    {
      "path": "db/__init__.py",
      "size": 0,
      "first_line": "",
      "docstring": null
    },
    {
      "path": "db/db_manager.py",
      "size": 30766,
      "first_line": "import os, sqlite3, time, json",
      "docstring": null
    },
    {
      "path": "db/indexes.sql",
      "size": 314,
      "first_line": "-- Optional indexes to speed up exports and dashboards",
      "docstring": null
    },
    {
      "path": "db/journal_schema.sql",
      "size": 3074,
      "first_line": "-- Aethelred Journal Schema (SQLite)",
      "docstring": null
    },
    {
      "path": "db/migrations/004_risk_state.sql",
      "size": 333,
      "first_line": "-- risk state store",
      "docstring": null
    },
    {
      "path": "db/migrations/005_trade_views.sql",
      "size": 134,
      "first_line": "create view if not exists v_trades as",
      "docstring": null
    },
    {
      "path": "db/migrations/2025_10_26_perf_views.sql",
      "size": 580,
      "first_line": "-- Example SQL views for realized pnl and trade count today",
      "docstring": null
    },
    {
      "path": "db/models.py",
      "size": 0,
      "first_line": "",
      "docstring": null
    },
    {
      "path": "db/pg_adapter.py",
      "size": 4522,
      "first_line": "from __future__ import annotations",
      "docstring": null
    },
    {
      "path": "db/schema.sql",
      "size": 703,
      "first_line": "CREATE TABLE IF NOT EXISTS trades (",
      "docstring": null
    },
    {
      "path": "db/test_db_manager.py",
      "size": 488,
      "first_line": "from db.db_manager import DBManager",
      "docstring": null
    },
    {
      "path": "db/utils.py",
      "size": 934,
      "first_line": "import sqlite3  # Built-in library for working with SQLite",
      "docstring": null
    },
    {
      "path": "db/views_journal.sql",
      "size": 2019,
      "first_line": "-- Views for daily PnL, per-symbol stats, and helper series",
      "docstring": null
    },
    {
      "path": "decisions.csv",
      "size": 14396,
      "first_line": "ts,symbol,strategy,regime,signal,intent,size_usd,price,ml_p_up,ml_vote,veto,reasons,planned_stop,planned_tp,run_id",
      "docstring": null
    },
    {
      "path": "docs/examples/decision_row.json",
      "size": 365,
      "first_line": "",
      "docstring": null
    },
    {
      "path": "docs/insight_journal.md",
      "size": 2937,
      "first_line": "# Aethelred Insight Journal and Metrics",
      "docstring": null
    },
    {
      "path": "docs/strategos.md",
      "size": 2577,
      "first_line": "# Strategos: Strategy Interface and Raw Signal Logging",
      "docstring": null
    },
    {
      "path": "docs/visor.md",
      "size": 838,
      "first_line": "# Aethelred Visor",
      "docstring": null
    },
    {
      "path": "eth_metrics.csv",
      "size": 628,
      "first_line": "ts,exchange,symbol,interval,strategy,signal,price,bars_used,ann_return,ann_vol,sharpe_ann,max_drawdown,win_rate_bar,profit_factor_bar,trade_count,avg_bar_return,paper_equity",
      "docstring": null
    },
    {
      "path": "exchange/__init__.py",
      "size": 0,
      "first_line": "",
      "docstring": null
    },
    {
      "path": "exchange/paper.py",
      "size": 2277,
      "first_line": "from __future__ import annotations",
      "docstring": null
    },
    {
      "path": "exports/demo_trades.csv",
      "size": 34,
      "first_line": "export failed: no such column: ts",
      "docstring": null
    },
    {
      "path": "exports_download/decisions.csv",
      "size": 73284,
      "first_line": "ts,symbol,strategy,regime,signal,intent,size_usd,price,ml_p_up,ml_vote,veto,reasons,planned_stop,planned_tp,run_id",
      "docstring": null
    },
    {
      "path": "exports_download/server_trades.csv",
      "size": 23,
      "first_line": "{\"detail\":\"Not Found\"}",
      "docstring": null
    },
    {
      "path": "exports_download/server_trades_client.csv",
      "size": 49,
      "first_line": "ts,symbol,side,qty,entry,exit,pnl,pnl_pct,hold_s",
      "docstring": null
    },
    {
      "path": "fetch_market_data.py",
      "size": 2690,
      "first_line": "# fetch_market_data.py",
      "docstring": null
    },
    {
      "path": "fixtures/journal_sample.sql",
      "size": 1065,
      "first_line": ".read db/journal_schema.sql",
      "docstring": null
    },
    {
      "path": "ml/__init__.py",
      "size": 270,
      "first_line": "from .feature_pipeline import build_features",
      "docstring": null
    },
    {
      "path": "ml/dataset_builder.py",
      "size": 1942,
      "first_line": "from __future__ import annotations",
      "docstring": null
    },
    {
      "path": "ml/feature_pipeline.py",
      "size": 4108,
      "first_line": "from __future__ import annotations",
      "docstring": null
    },
    {
      "path": "ml/labeler.py",
      "size": 3046,
      "first_line": "from __future__ import annotations",
      "docstring": null
    },
    {
      "path": "ml/metrics.py",
      "size": 1698,
      "first_line": "from __future__ import annotations",
      "docstring": null
    },
    {
      "path": "ml/train_intent_veto.py",
      "size": 4986,
      "first_line": "from __future__ import annotations",
      "docstring": null
    },
    {
      "path": "models/.gitkeep",
      "size": 42,
      "first_line": "#",
      "docstring": null
    },
    {
      "path": "ops/__init__.py",
      "size": 0,
      "first_line": "",
      "docstring": null
    },
    {
      "path": "ops/flatten.py",
      "size": 949,
      "first_line": "try:",
      "docstring": null
    },
    {
      "path": "ops/notifier.py",
      "size": 676,
      "first_line": "from __future__ import annotations",
      "docstring": null
    },
    {
      "path": "ops/qa_dev_engine.py",
      "size": 3332,
      "first_line": "from __future__ import annotations",
      "docstring": null
    },
    {
      "path": "pyproject.toml",
      "size": 1111,
      "first_line": "[tool.ruff]",
      "docstring": null
    },
    {
      "path": "repo_index_compact.json",
      "size": 48803,
      "first_line": "{",
      "docstring": null
    },
    {
      "path": "requirements-dev.txt",
      "size": 54,
      "first_line": "pre-commit",
      "docstring": null
    },
    {
      "path": "requirements.txt",
      "size": 196,
      "first_line": "PyYAML>=6.0",
      "docstring": null
    },
    {
      "path": "risk/engine.py",
      "size": 3613,
      "first_line": "from dataclasses import dataclass",
      "docstring": null
    },
    {
      "path": "risk/state.py",
      "size": 1366,
      "first_line": "from db.db_manager import _get_conn",
      "docstring": null
    },
    {
      "path": "risk/taxonomy.py",
      "size": 348,
      "first_line": "class Reason:",
      "docstring": null
    },
    {
      "path": "run.py",
      "size": 1761,
      "first_line": "import argparse",
      "docstring": null
    },
    {
      "path": "run_live.py",
      "size": 230,
      "first_line": "\"\"\"",
      "docstring": "Deprecated: use run.py\nKept temporarily to avoid breaking shortcuts.\nThis shim forwards to the unified runner.\nWill be removed after the next release."
    },
    {
      "path": "runner/position_sizer.py",
      "size": 1399,
      "first_line": "from typing import Dict, Tuple",
      "docstring": null
    },
    {
      "path": "runner_paper.py",
      "size": 543,
      "first_line": "\"\"\"Tiny shim kept for backwards compatibility.",
      "docstring": "Tiny shim kept for backwards compatibility. \n This file intentionally forwards to the new unified runner `run.main`.\nIt avoids importing heavy runtime-only modules at import time to keep\npre-commit / linters happy."
    },
    {
      "path": "runtime/account_runtime.json",
      "size": 112,
      "first_line": "{\"equity_now\": 0.0, \"total_notional\": 0.0, \"pnl_unrealized_pct\": 0.0, \"positions\": [], \"ts\": 1761227906.362447}",
      "docstring": null
    },
    {
      "path": "runtime/news_items.json",
      "size": 25091,
      "first_line": "[{\"title\": \"US Treasury chief Bessent says 'substantial' trade framework with China reached\", \"link\": \"https://cointelegraph.com/news/bessent-substantial-trade-framework-china?utm_source=rss_feed&utm_",
      "docstring": null
    },
    {
      "path": "runtime_100/.path_logged",
      "size": 3,
      "first_line": "ok",
      "docstring": null
    },
    {
      "path": "runtime_100/BTC_USDT_runtime.json",
      "size": 440,
      "first_line": "{\"ts\":\"2025-10-23T13:58:46.400551+00:00\",\"symbol\":\"BTC/USDT\",\"regime\":\"chop\",\"strategy\":\"rsi_mean_revert\",\"breaker\":{\"active\":true,\"cooldown_until\":\"2025-10-23T14:12:53.233056+00:00\",\"reason\":\"panic\"}",
      "docstring": null
    },
    {
      "path": "runtime_100/ETH_USDT_runtime.json",
      "size": 433,
      "first_line": "{\"ts\":\"2025-10-23T13:58:40.519898+00:00\",\"symbol\":\"ETH/USDT\",\"regime\":\"chop\",\"strategy\":\"rsi_mean_revert\",\"breaker\":{\"active\":true,\"cooldown_until\":\"2025-10-23T14:12:53.233056+00:00\",\"reason\":\"panic\"}",
      "docstring": null
    },
    {
      "path": "runtime_100/SOL_USDT_runtime.json",
      "size": 427,
      "first_line": "{\"ts\":\"2025-10-23T13:58:05.431799+00:00\",\"symbol\":\"SOL/USDT\",\"regime\":\"trend\",\"strategy\":\"ema_trend\",\"breaker\":{\"active\":true,\"cooldown_until\":\"2025-10-23T14:12:53.233056+00:00\",\"reason\":\"panic\"},\"int",
      "docstring": null
    },
    {
      "path": "runtime_100/account_runtime.json",
      "size": 120,
      "first_line": "{\"ts\": 1761227951.208264, \"equity\": 12018.28258778062, \"cash\": 12018.28258778062, \"exposure_usd\": 0.0, \"positions\": []}",
      "docstring": null
    },
    {
      "path": "runtime_100/heartbeat.txt",
      "size": 11,
      "first_line": "1761227906",
      "docstring": null
    },
    {
      "path": "runtime_100/news_items.json",
      "size": 25195,
      "first_line": "[{\"title\": \"Bitcoin treasuries can earn more Bitcoin, says Willem Schro\u00e9\", \"link\": \"https://cointelegraph.com/news/bitcoin-treasuries-earn-more-bitcoin-willem-schroe-botanix?utm_source=rss_feed&utm_me",
      "docstring": null
    },
    {
      "path": "scripts/README.md",
      "size": 386,
      "first_line": "Scripts",
      "docstring": null
    },
    {
      "path": "scripts/accept_ops.ps1",
      "size": 1294,
      "first_line": "param(",
      "docstring": null
    },
    {
      "path": "scripts/accept_ops.sh",
      "size": 789,
      "first_line": "#!/usr/bin/env bash",
      "docstring": null
    },
    {
      "path": "scripts/dev_check.ps1",
      "size": 749,
      "first_line": "param(",
      "docstring": null
    },
    {
      "path": "scripts/dev_check.sh",
      "size": 102,
      "first_line": "#!/usr/bin/env bash",
      "docstring": null
    },
    {
      "path": "scripts/dump_db_exports.py",
      "size": 1621,
      "first_line": "import sqlite3",
      "docstring": null
    },
    {
      "path": "scripts/dump_openapi.py",
      "size": 689,
      "first_line": "\"\"\"Dump the FastAPI app OpenAPI JSON to `api/openapi.json`.",
      "docstring": "Dump the FastAPI app OpenAPI JSON to `api/openapi.json`. \n This imports the FastAPI app from `api.main` and writes `app.openapi()` to file."
    },
    {
      "path": "scripts/dump_trades_info.py",
      "size": 479,
      "first_line": "import sqlite3",
      "docstring": null
    },
    {
      "path": "scripts/eval_stop_distance_v1.py",
      "size": 2813,
      "first_line": "#!/usr/bin/env python3",
      "docstring": null
    },
    {
      "path": "scripts/export_db.py",
      "size": 1794,
      "first_line": "\"\"\"Export paper_trades and decisions tables from the local SQLite DB to CSV and JSONL files.",
      "docstring": "Export paper_trades and decisions tables from the local SQLite DB to CSV and JSONL files.\nUsage: python scripts/export_db.py [out_dir]"
    },
    {
      "path": "scripts/export_ohlcv_parquet.py",
      "size": 2295,
      "first_line": "#!/usr/bin/env python3",
      "docstring": null
    },
    {
      "path": "scripts/generate_repo_index.py",
      "size": 2009,
      "first_line": "\"\"\"Generate a lightweight JSON index of the repository useful for LLM ingestion.",
      "docstring": "Generate a lightweight JSON index of the repository useful for LLM ingestion. \n Writes repo_index.json with: path, size, first_line, docstring (if Python), and sha1 (optional)."
    },
    {
      "path": "scripts/generate_repo_index_compact.py",
      "size": 2324,
      "first_line": "\"\"\"Generate a compact JSON index of the repository suitable for committing.",
      "docstring": "Generate a compact JSON index of the repository suitable for committing. \n This writes `repo_index_compact.json` with limited fields to keep size small.\n- skips large files (>100KB)\n- only includes path, size, first_line, docstring (truncated to 512 chars) \n Intended for CI to regenerate for LLM ingestion without bloating the repo."
    },
    {
      "path": "scripts/list_routes.py",
      "size": 296,
      "first_line": "from pathlib import Path",
      "docstring": null
    },
    {
      "path": "scripts/list_tables.py",
      "size": 406,
      "first_line": "import sqlite3",
      "docstring": null
    },
    {
      "path": "scripts/prune_legacy.py",
      "size": 2355,
      "first_line": "import argparse",
      "docstring": null
    },
    {
      "path": "scripts/pull_decisions.py",
      "size": 1039,
      "first_line": "import argparse",
      "docstring": null
    },
    {
      "path": "scripts/pull_exports.ps1",
      "size": 639,
      "first_line": "param(",
      "docstring": null
    },
    {
      "path": "scripts/retrain.ps1",
      "size": 277,
      "first_line": "$env:PYTHONPATH=\".\"",
      "docstring": null
    },
    {
      "path": "scripts/risk_drill.ps1",
      "size": 985,
      "first_line": "param([int]$Hours=4)",
      "docstring": null
    },
    {
      "path": "scripts/run_migrations.py",
      "size": 1149,
      "first_line": "#!/usr/bin/env python",
      "docstring": "Simple migration runner for Postgres that executes all *.sql files in db/migrations in lexical order.\nUsage:\n  DB_URL=postgres://... python scripts/run_migrations.py"
    },
    {
      "path": "scripts/run_paper.ps1",
      "size": 1794,
      "first_line": "\ufeff# run_paper.ps1",
      "docstring": null
    },
    {
      "path": "scripts/run_paper_loop.ps1",
      "size": 1940,
      "first_line": "# run_paper_loop.ps1",
      "docstring": null
    },
    {
      "path": "scripts/run_paper_quick.ps1",
      "size": 1573,
      "first_line": "Param(",
      "docstring": null
    },
    {
      "path": "scripts/run_retrain_nightly.ps1",
      "size": 1872,
      "first_line": "# run_retrain_nightly.ps1",
      "docstring": null
    },
    {
      "path": "scripts/run_visor.ps1",
      "size": 315,
      "first_line": "param(",
      "docstring": null
    },
    {
      "path": "scripts/run_visor.sh",
      "size": 310,
      "first_line": "#!/usr/bin/env bash",
      "docstring": null
    },
    {
      "path": "scripts/sample_data.py",
      "size": 1444,
      "first_line": "#!/usr/bin/env python3",
      "docstring": null
    },
    {
      "path": "scripts/test_export_client.py",
      "size": 442,
      "first_line": "import sys",
      "docstring": null
    },
    {
      "path": "scripts/train_intent_veto.sh",
      "size": 202,
      "first_line": "#!/usr/bin/env bash",
      "docstring": null
    },
    {
      "path": "scripts/train_intent_veto_v1.py",
      "size": 7402,
      "first_line": "#!/usr/bin/env python3",
      "docstring": null
    },
    {
      "path": "scripts/train_stop_distance_regressor_v1.py",
      "size": 8556,
      "first_line": "#!/usr/bin/env python3",
      "docstring": null
    },
    {
      "path": "scripts/watchdog.py",
      "size": 1705,
      "first_line": "import time",
      "docstring": null
    },
    {
      "path": "sizing/__init__.py",
      "size": 401,
      "first_line": "from .vol_target import (",
      "docstring": null
    },
    {
      "path": "sizing/vol_target.py",
      "size": 3546,
      "first_line": "import math",
      "docstring": null
    },
    {
      "path": "sol_metrics.csv",
      "size": 644,
      "first_line": "ts,exchange,symbol,interval,strategy,signal,price,bars_used,ann_return,ann_vol,sharpe_ann,max_drawdown,win_rate_bar,profit_factor_bar,trade_count,avg_bar_return,paper_equity",
      "docstring": null
    },
    {
      "path": "strategy/__init__.py",
      "size": 0,
      "first_line": "",
      "docstring": null
    },
    {
      "path": "strategy/donchian_close.py",
      "size": 938,
      "first_line": "# strategy/donchian_close.py",
      "docstring": null
    },
    {
      "path": "strategy/ema_trend.py",
      "size": 567,
      "first_line": "from __future__ import annotations",
      "docstring": null
    },
    {
      "path": "strategy/ma_crossover.py",
      "size": 538,
      "first_line": "import pandas as pd",
      "docstring": null
    },
    {
      "path": "strategy/pairs_threshold_revert.py",
      "size": 1064,
      "first_line": "# strategy/pairs_threshold_revert.py",
      "docstring": null
    },
    {
      "path": "strategy/rsi_mean_revert.py",
      "size": 748,
      "first_line": "from __future__ import annotations",
      "docstring": null
    },
    {
      "path": "strategy/selector.py",
      "size": 1802,
      "first_line": "from __future__ import annotations",
      "docstring": null
    },
    {
      "path": "strategy/trade_logic.py",
      "size": 1881,
      "first_line": "import random",
      "docstring": null
    },
    {
      "path": "tests/__init__.py",
      "size": 0,
      "first_line": "",
      "docstring": null
    },
    {
      "path": "tests/fixtures/journal_sample.sql",
      "size": 1065,
      "first_line": ".read db/journal_schema.sql",
      "docstring": null
    },
    {
      "path": "tests/test_core_risk_regime_breaker.py",
      "size": 1741,
      "first_line": "import math",
      "docstring": null
    },
    {
      "path": "tests/test_db_manager.py",
      "size": 1487,
      "first_line": "import os",
      "docstring": null
    },
    {
      "path": "tests/test_decisions_header_contract.py",
      "size": 375,
      "first_line": "from api.contracts.decisions_header import DECISIONS_HEADER",
      "docstring": null
    },
    {
      "path": "tests/test_execution_engine.py",
      "size": 2155,
      "first_line": "import sys",
      "docstring": null
    },
    {
      "path": "tests/test_export_decisions_coalesce.py",
      "size": 486,
      "first_line": "from fastapi.testclient import TestClient",
      "docstring": null
    },
    {
      "path": "tests/test_export_decisions_csv.py",
      "size": 486,
      "first_line": "from fastapi.testclient import TestClient",
      "docstring": null
    },
    {
      "path": "tests/test_export_decisions_schema.py",
      "size": 376,
      "first_line": "from fastapi.testclient import TestClient",
      "docstring": null
    },
    {
      "path": "tests/test_live_ohlcv.py",
      "size": 689,
      "first_line": "from bot.exchange import Exchange",
      "docstring": null
    },
    {
      "path": "tests/test_metrics_replay_consistency.py",
      "size": 6288,
      "first_line": "import os",
      "docstring": null
    },
    {
      "path": "tests/test_regime_config.py",
      "size": 851,
      "first_line": "from core.strategy.regime_config import load_regime_map",
      "docstring": null
    },
    {
      "path": "tests/test_regime_map_env.py",
      "size": 831,
      "first_line": "import os",
      "docstring": null
    },
    {
      "path": "tests/test_sizing_vol.py",
      "size": 617,
      "first_line": "import math",
      "docstring": null
    },
    {
      "path": "tests/test_strategy_interface.py",
      "size": 603,
      "first_line": "import numpy as np",
      "docstring": null
    },
    {
      "path": "tests/test_strategy_logic.py",
      "size": 1576,
      "first_line": "import random",
      "docstring": null
    },
    {
      "path": "tests/test_strategy_registry.py",
      "size": 443,
      "first_line": "from core.strategy import registry",
      "docstring": null
    },
    {
      "path": "tests/test_strategy_selector.py",
      "size": 2028,
      "first_line": "from typing import Any, Dict",
      "docstring": null
    },
    {
      "path": "tests/test_strategy_selector_names.py",
      "size": 283,
      "first_line": "from core.strategy.selector import StrategySelector",
      "docstring": null
    },
    {
      "path": "tests_api/conftest.py",
      "size": 144,
      "first_line": "import sys",
      "docstring": null
    },
    {
      "path": "tests_api/test_demo_paper_quick.py",
      "size": 217,
      "first_line": "from fastapi.testclient import TestClient",
      "docstring": null
    },
    {
      "path": "tests_api/test_endpoints.py",
      "size": 3897,
      "first_line": "# tests_api/test_endpoints.py",
      "docstring": null
    },
    {
      "path": "tests_api/test_export_endpoints.py",
      "size": 1188,
      "first_line": "from fastapi.testclient import TestClient",
      "docstring": null
    },
    {
      "path": "tests_api/test_healthz_shape.py",
      "size": 695,
      "first_line": "from fastapi.testclient import TestClient",
      "docstring": null
    },
    {
      "path": "tests_api/test_insight_metrics_api.py",
      "size": 1317,
      "first_line": "import os",
      "docstring": null
    },
    {
      "path": "tests_api/test_intent_veto.py",
      "size": 1382,
      "first_line": "from fastapi.testclient import TestClient",
      "docstring": null
    },
    {
      "path": "tests_api/test_metrics_seed_positions_http.py",
      "size": 1442,
      "first_line": "from typing import Any, Dict, List",
      "docstring": null
    },
    {
      "path": "tests_api/test_no_qa_in_live.py",
      "size": 435,
      "first_line": "from importlib import reload",
      "docstring": null
    },
    {
      "path": "tests_api/test_ops_flatten_health.py",
      "size": 1215,
      "first_line": "from fastapi.testclient import TestClient",
      "docstring": null
    },
    {
      "path": "tests_api/test_ops_flatten_http.py",
      "size": 730,
      "first_line": "from fastapi.testclient import TestClient",
      "docstring": null
    },
    {
      "path": "tests_api/test_risk_http_smoke.py",
      "size": 2481,
      "first_line": "from fastapi.testclient import TestClient",
      "docstring": null
    },
    {
      "path": "tests_api/test_risk_veto_paths.py",
      "size": 3003,
      "first_line": "from typing import Dict, Any",
      "docstring": null
    },
    {
      "path": "tests_api/test_runtime_json.py",
      "size": 797,
      "first_line": "import json",
      "docstring": null
    },
    {
      "path": "tests_api/test_smoke_api.py",
      "size": 217,
      "first_line": "from fastapi.testclient import TestClient",
      "docstring": null
    },
    {
      "path": "tests_api/test_snapshot_realized.py",
      "size": 626,
      "first_line": "from pathlib import Path",
      "docstring": null
    },
    {
      "path": "tests_api/test_train_endpoint.py",
      "size": 595,
      "first_line": "from fastapi.testclient import TestClient",
      "docstring": null
    },
    {
      "path": "tests_core/test_persistence.py",
      "size": 1146,
      "first_line": "from core.persistence import init_db, record_equity, record_trade, recent_stats_7d, DB_PATH",
      "docstring": null
    },
    {
      "path": "tests_core/test_risk_regime_breaker.py",
      "size": 1734,
      "first_line": "import pandas as pd",
      "docstring": null
    },
    {
      "path": "tests_core/test_selector.py",
      "size": 475,
      "first_line": "from strategy.selector import pick_by_regime",
      "docstring": null
    },
    {
      "path": "tests_ml/__init__.py",
      "size": 66,
      "first_line": "# Marks tests_ml as a package so pytest can discover it reliably.",
      "docstring": null
    },
    {
      "path": "tests_ml/test_ml_ece_threshold.py",
      "size": 1229,
      "first_line": "import json",
      "docstring": null
    },
    {
      "path": "tests_ml/test_ml_training.py",
      "size": 5198,
      "first_line": "import json",
      "docstring": null
    },
    {
      "path": "tools/acceptance_probe.py",
      "size": 1713,
      "first_line": "import sqlite3",
      "docstring": null
    },
    {
      "path": "tools/acceptance_run.py",
      "size": 3155,
      "first_line": "import os",
      "docstring": null
    },
    {
      "path": "tools/apply_patch.ps1",
      "size": 769,
      "first_line": "\ufeffparam(",
      "docstring": null
    },
    {
      "path": "tools/export_ohlcv_csv.py",
      "size": 1855,
      "first_line": "from __future__ import annotations",
      "docstring": null
    },
    {
      "path": "tools/seed_paper_state.py",
      "size": 953,
      "first_line": "import os",
      "docstring": null
    },
    {
      "path": "trades.csv",
      "size": 156,
      "first_line": "ts_open,ts_close,symbol,side,qty,entry,exit,pnl,pnl_pct,fee_usd,slippage_bps,note",
      "docstring": null
    },
    {
      "path": "utils/__init__.py",
      "size": 0,
      "first_line": "",
      "docstring": null
    },
    {
      "path": "utils/aud.py",
      "size": 423,
      "first_line": "import pathlib, time, json",
      "docstring": null
    },
    {
      "path": "utils/config.py",
      "size": 1964,
      "first_line": "from dataclasses import dataclass",
      "docstring": null
    },
    {
      "path": "utils/logger.py",
      "size": 412,
      "first_line": "# utils/logger.py",
      "docstring": null
    },
    {
      "path": "utils/mtm.py",
      "size": 1006,
      "first_line": "import json",
      "docstring": null
    },
    {
      "path": "utils/run_id.py",
      "size": 185,
      "first_line": "from datetime import datetime",
      "docstring": null
    },
    {
      "path": "utils/settings.py",
      "size": 251,
      "first_line": "import os",
      "docstring": null
    },
    {
      "path": "utils/snapshot.py",
      "size": 2374,
      "first_line": "import json",
      "docstring": null
    },
    {
      "path": "watchdog.ps1",
      "size": 274,
      "first_line": "$script = \"python runner_paper.py\"",
      "docstring": null
    }
  ]
}